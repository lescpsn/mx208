fix deadlock bug led to server stops.
add doxygen support.
